package best.lettuce.modules.impl.exploit;

import best.lettuce.event.base.EventListener;
import best.lettuce.event.impl.network.EventPacketReceive;
import best.lettuce.modules.Category;
import best.lettuce.modules.Module;
import best.lettuce.utils.packet.PacketUtils;
import net.minecraft.network.play.client.C19PacketResourcePackStatus;
import net.minecraft.network.play.server.S48PacketResourcePackSend;

public class ResourcePackSpoof extends Module {
    public ResourcePackSpoof(){
        super("Resource Pack Spoof", Category.EXPLOIT, "Sends C19 packet to the server to make it thinks the pack is loaded.");
    }

    public final EventListener<EventPacketReceive> onPacket = event -> {
        if(event.getPacket() instanceof S48PacketResourcePackSend){
            S48PacketResourcePackSend packet = (S48PacketResourcePackSend) event.getPacket();
            PacketUtils.sendPacketNoEvent(new C19PacketResourcePackStatus(packet.getHash(), C19PacketResourcePackStatus.Action.SUCCESSFULLY_LOADED));
            event.setCancelled(true);
        }
    };
}
